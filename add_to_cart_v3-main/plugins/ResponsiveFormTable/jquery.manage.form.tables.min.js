"use strict";!function(e,n,t,i){const o="manageFormTables";class s{constructor(n,t){this.element=e(n),this.settings=e.extend(!0,{},e.fn[o].defaults,t),this.logs=[],this._init(),this._show()}_init(){this._buildManageFormTables()}_buildManageFormTables(){const n=this;n._configValidationEngine();let t=!0;n._isValidString(n.settings.senderTarget)||(t=!1,n._log("no senderTarget provided","error"));let i=!0;n._isValidString(n.settings.removeRowTarget)||(i=!1,n._log("no removeRowTarget provided","error"));let o=!0;this._isValidString(n.settings.addRowTarget)||(o=!1,n._log("no addRowTarget provided","error"));let s=!0;n._isValidNumber(n.settings.minRowsVisible)||(s=!1,n._log("no minRowsVisible provided","error"));let r=!0;n._isValidString(n.settings.templateRow)||(r=!1,n._log("no templateRow provided","warn"));let a=!0;e.validationEngine.defaults||(a=!1,n._log("no validationEngine function provided","info"));let l=!0;n._isValidFunction(n.settings.onSubmit)||(l=!1,n._log("no onSubmit function provided","warn"));let d=!0;n._isValidFunction(n.settings.onErrorRowsVisible)||(d=!1,n._log("no onErrorRowsVisible function provided","warn"));let g=!0;e.isArray(n.settings.events)&&e.each(n.settings.events,(function(e,t){n._isValidFunction(t.onEvent)||(g=!1,n._log("no onEvent function provided","warn")),n._isValidString(t.onEventName)||(g=!1,n._log("no onErrorRowsVisible function provided","warn")),n._isValidString(t.targetName)||(g=!1,n._log("no onErrorRowsVisible function provided","warn"))}));const c=n.element.closest("form");e(n.settings.senderTarget).hide(),e(n.settings.addRowTarget,n.element).on("click",(function(){if(o&&r){const o=e(n.settings.templateRow).appendTo(n.element);return t&&e(n.settings.senderTarget).show(),i&&e(n.settings.removeRowTarget,o).on("click",(function(){if(s){const t=e(this).closest("tbody").find("tr").length;t>n.settings.minRowsVisible?e(this).closest("tr").remove():d&&(n.settings.onErrorRowsVisible(n.element,c),n._log("It is not allowed to delete rows less than "+n.settings.minRowsVisible,"error")),t<=0&&e(n.settings.senderTarget).hide()}else e(this).closest("tr").remove()})),g&&e.each(n.settings.events,(function(n,t){e(t.targetName,o).on(t.onEventName,t.onEvent)})),!1}})),t&&e(n.settings.senderTarget).on("click",(function(){a&&c.validationEngine("attach")})),l&&c.on("submit",(function(){return!(a&&!c.validationEngine("validate"))&&n.settings.onSubmit(c)}))}_configValidationEngine(){if(!e.validationEngine)return!1;e.validationEngine.defaults.promptPosition="inline",e.validationEngine.defaults.onFieldFailure=function(e){e.removeClass("is-valid").addClass("is-invalid")},e.validationEngine.defaults.onFieldSuccess=function(e){e.removeClass("is-invalid").addClass("is-valid")}}_isValidFunction(e){let n=!1;"function"==typeof e&&(n=!0);let t=!1;if(n){e.toString().match(/\{([\s\S]*)\}/m)[1].replace(/^\s*\/\/.*$/gm,"").length>0&&(t=!0)}return n&&t}_isValidString(e){return"string"==typeof e&&e.trim()}_isValidNumber(n){return"number"==typeof n&&e.isNumeric(n)}_log(e,n){let t="log";["log","error","info","warn"].includes(n)&&(t=n),this.logs.push({type:t,content:e})}_show(){1===this.settings.debug&&e.each(this.logs,(function(e,n){console[n.type](o+": "+n.content+".")}))}}e.fn[o]=function(e){if("object"==typeof e)return this.each((function(n,t){new s(this,e)}));console.error(o+": invalid options.")},e.fn[o].defaults={templateRow:'\n                    <tr role="row">\n                        <td role="cell">\n                            <a href="javascript:void(0);" class="btn btn-danger btn-sm remove">\n                                <i class="fa fa-times"></i>\n                            </a>\n                       </td>\n                    </tr>   \n                  ',removeRowTarget:".remove",addRowTarget:".add-row",minRowsVisible:1,debug:0,senderTarget:".sender",onSubmit:function(e){},onErrorRowsVisible(e,n){},events:[{targetName:"edit",onEventName:"click",onEvent:function(){}}]}}(jQuery,window,document);